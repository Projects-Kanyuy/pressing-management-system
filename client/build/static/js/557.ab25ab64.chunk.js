/*! For license information please see 557.ab25ab64.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[557],{1360:(e,a,r)=>{r.d(a,{A:()=>t});const t=(0,r(7784).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},1873:(e,a,r)=>{r.d(a,{A:()=>F});var t=r(5043),s=r(1283),l=r(4117),n=r(5016),i=r(3280),d=r(6174),o=r(722),c=r(7184),m=r(614),p=r(409),u=r(579);const x=e=>{let{item:a,index:r,onRemove:t,onChange:s,itemTypes:n=[],serviceTypes:c=[],calculatedPrice:x}=e;const y=(e,r)=>{s(a.id,e,r)},{t:g}=(0,l.Bd)(),{settings:h}=(0,p.I)(),f=h.defaultCurrencySymbol;return(0,u.jsxs)("div",{className:"p-4 border border-apple-gray-200 dark:border-apple-gray-700 rounded-apple-md shadow-apple-sm bg-apple-gray-50 dark:bg-apple-gray-800/30",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,u.jsx)("h4",{className:"text-md font-medium text-apple-gray-700 dark:text-apple-gray-300",children:g("orderItemRow.itemNumber",{number:r+1})}),(0,u.jsx)(o.A,{type:"button",onClick:t,variant:"ghost",size:"sm",className:"text-apple-red hover:bg-red-100/50 dark:hover:bg-red-900/30 p-1 -mr-1 -mt-1",title:g("orderItemRow.accessibility.removeItem"),"aria-label":g("orderItemRow.accessibility.removeItemWithNumber",{number:r+1}),children:(0,u.jsx)(m.A,{size:18})})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-x-4 gap-y-2 items-end",children:[(0,u.jsx)("div",{className:"md:col-span-3",children:(0,u.jsx)(d.A,{label:g("orderItemRow.itemType"),id:`itemType-${a.id}`,value:a.itemType,onChange:e=>y("itemType",e.target.value),options:n.map(e=>({value:e,label:e})),placeholder:g("orderItemRow.placeholders.selectItemType"),required:!0,className:"mb-0"})}),(0,u.jsx)("div",{className:"md:col-span-3",children:(0,u.jsx)(d.A,{label:g("orderItemRow.serviceType"),id:`serviceType-${a.id}`,value:a.serviceType,onChange:e=>y("serviceType",e.target.value),options:c,placeholder:g("orderItemRow.placeholders.selectServiceType"),required:!0,className:"mb-0"})}),(0,u.jsx)("div",{className:"md:col-span-1",children:(0,u.jsx)(i.A,{label:g("orderItemRow.quantity"),id:`quantity-${a.id}`,type:"number",value:a.quantity,onChange:e=>y("quantity",parseInt(e.target.value,10)||1),min:"1",required:!0,className:"mb-0"})}),(0,u.jsx)("div",{className:"md:col-span-3",children:(0,u.jsx)(i.A,{label:g("orderItemRow.specialInstructions"),id:`specialInstructions-${a.id}`,value:a.specialInstructions,onChange:e=>y("specialInstructions",e.target.value),placeholder:g("orderItemRow.placeholders.specialInstructions"),className:"mb-0"})}),(0,u.jsxs)("div",{className:"md:col-span-2",children:[(0,u.jsx)("label",{htmlFor:`itemPrice-${a.id}`,className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300 ",children:g("orderItemRow.linePrice")}),(0,u.jsx)("div",{id:`itemPrice-${a.id}`,className:"h-10 flex items-center justify-end px-3 py-2 border border-apple-gray-300 dark:border-apple-gray-700 rounded-apple shadow-sm bg-apple-gray-100 dark:bg-apple-gray-800 text-apple-gray-700 dark:text-apple-gray-100 sm:text-sm",children:(0,u.jsxs)("span",{className:"font-medium",children:[f,(x||0).toFixed(2)]})})]})]})]})};var y=r(5873),g=r(7457),h=r(6260),f=r(9621),b=r(7719),v=r(9292),j=r(1884),N=r(7784);const k=(0,N.A)("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);var T=r(1360);const O=(0,N.A)("square-check-big",[["path",{d:"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5",key:"1uzm8b"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),A=(0,N.A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),C=(0,N.A)("square-x",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var w=r(8693),M=r(8666),I=r(7257),S=r(4653),D=r(2316);function $(e,a,r){const t=(0,D.a)(e,r?.in);return t.setSeconds(a),t}function q(e,a,r){const t=(0,D.a)(e,r?.in);return t.setMinutes(a),t}function P(e,a,r){const t=(0,D.a)(e,r?.in);return t.setHours(a),t}const F=e=>{var a;let{initialOrderData:r,isEditMode:m=!1}=e;const{t:N}=(0,l.Bd)(),D=(0,s.Zp)(),{settings:F,loadingSettings:z}=(0,p.I)(),{user:L}=(0,n.A)(),[R,H]=(0,t.useState)({itemTypes:[],serviceTypes:[],priceList:[],currencySymbol:"$",loading:!0}),U=(0,t.useCallback)(()=>({id:Date.now()+Math.random(),itemType:"",serviceType:"",quantity:1,specialInstructions:""}),[]),[V,_]=(0,t.useState)([U()]),[E,Z]=(0,t.useState)("none"),[G,Y]=(0,t.useState)("0"),[B,W]=(0,t.useState)("0"),[J,K]=(0,t.useState)(""),Q=(0,M.GP)(new Date(Date.now()+2592e5),"yyyy-MM-dd"),X="17:00",[ee,ae]=(0,t.useState)(Q),[re,te]=(0,t.useState)(X),[se,le]=(0,t.useState)({name:"",phone:"",email:"",address:""}),[ne,ie]=(0,t.useState)(null),[de,oe]=(0,t.useState)(""),[ce,me]=(0,t.useState)([]),[pe,ue]=(0,t.useState)(!1),[xe,ye]=(0,t.useState)(m&&null!==r&&void 0!==r&&null!==(a=r.customer)&&void 0!==a&&a._id?"existing":"new"),[ge,he]=(0,t.useState)(!1),[fe,be]=(0,t.useState)(""),[ve,je]=(0,t.useState)(!1),[Ne,ke]=(0,t.useState)(null);(0,t.useEffect)(()=>{(async()=>{try{const[e,a]=await Promise.all([(0,f.V3)(),(0,f.$B)()]);H({itemTypes:e.data.itemTypes||[],serviceTypes:e.data.serviceTypes||[],priceList:a.data||[],currencySymbol:e.data.defaultCurrencySymbol||"FCFA",loading:!1})}catch(e){be(N("createOrder.form.validation.couldNotLoadData")),console.error("Failed to load operational data:",e),H(e=>({...e,loading:!1}))}})()},[]);F.defaultCurrencySymbol;(0,t.useEffect)(()=>{if(m&&r){var e;if(r.customer&&(le({name:r.customer.name||"",phone:r.customer.phone||"",email:r.customer.email||"",address:r.customer.address||""}),ie(r.customer._id),ye("existing")),_((null===(e=r.items)||void 0===e?void 0:e.map(e=>({...e,id:e._id||Date.now()+Math.random(),quantity:e.quantity||1})))||[U()]),r.expectedPickupDate&&(0,I.f)((0,S.H)(r.expectedPickupDate))){const e=(0,S.H)(r.expectedPickupDate);ae((0,M.GP)(e,"yyyy-MM-dd")),te((0,M.GP)(e,"HH:mm"))}else ae(Q),te(X);Z(r.discountType||"none"),Y(String(r.discountValue||0)),W(String(r.amountPaid||0)),K(r.notes||"")}},[r,m,U,Q,X]);const Te=(e,a,r)=>_(V.map(t=>t.id===e?{...t,[a]:"quantity"===a?parseInt(r,10)||1:r}:t)),Oe=e=>le({...se,[e.target.name]:e.target.value}),Ae=(0,t.useCallback)((e,a)=>{if(!e||!a)return 0;const r=a.toLowerCase(),t=R.priceList.find(a=>a.itemType===e&&a.serviceType.toLowerCase()===r);return t||console.log(`[getItemPrice] No price found for Item: '${e}', Service: '${r}'. Checking against price list:`,R.priceList),t?t.price:0},[R.priceList]),Ce=(0,t.useMemo)(()=>parseFloat(V.reduce((e,a)=>e+Ae(a.itemType,a.serviceType)*(parseInt(a.quantity,10)||0),0).toFixed(2)),[V,Ae]),{calculatedDiscountAmount:we,finalTotalAmount:Me}=(0,t.useMemo)(()=>{let e=0;const a=parseFloat(G)||0;"percentage"===E&&Ce>0&&a>0?e=Ce*a/100:"fixed"===E&&a>0&&(e=a),e>Ce&&(e=Ce);const r=parseFloat(e.toFixed(2));return{calculatedDiscountAmount:r,finalTotalAmount:parseFloat((Ce-r).toFixed(2))}},[Ce,E,G]),Ie=(0,t.useMemo)(()=>Math.max(0,Me-(parseFloat(B)||0)),[Me,B]);return R.loading?(0,u.jsxs)("div",{className:"p-8 flex justify-center items-center",children:[(0,u.jsx)(g.A,{size:"lg"}),(0,u.jsx)("p",{className:"ml-1 mt-2 text-sm text-apple-gray-500",children:N("createOrder.form.loadingData")})]}):R.loading||0!==R.itemTypes.length?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),be(""),"new"===xe&&(!se.name||!se.phone))return void be(N("createOrder.form.validation.customerNamePhoneRequired"));if("existing"===xe&&!ne&&!m)return void be(N("createOrder.form.validation.selectCustomerRequired"));if(V.some(e=>!e.itemType||!e.serviceType||!e.quantity||parseInt(e.quantity,10)<1))return void be(N("createOrder.form.validation.itemsRequired"));if(!ee||!(0,I.f)((0,S.H)(ee))||!re)return void be(N("createOrder.form.validation.pickupDateRequired"));const[a,r]=re.split(":").map(Number);let t=$(q(P((0,S.H)(ee),a),r),0);(0,I.f)(t)?(ke({isEditMode:m,customer:{...se,id:ne},customerSelectionMode:xe,items:V.map(e=>{let{id:a,...r}=e;return{...r,quantity:parseInt(r.quantity,10)||1,serviceType:r.serviceType.toLowerCase()}}),expectedPickupDate:t.toISOString(),subTotalAmount:Ce,discountType:E,discountValue:parseFloat(G)||0,calculatedDiscountAmount:we,finalTotalAmount:Me,amountPaid:parseFloat(B)||0,notes:J,balanceDue:Ie}),je(!0)):be(N("createOrder.form.validation.invalidDateTime"))},className:"space-y-8 divide-y divide-apple-gray-200 dark:divide-apple-gray-700",children:[fe&&(0,u.jsxs)("div",{className:"p-3 mb-4 bg-red-100 text-apple-red rounded-apple border border-red-300 dark:border-red-700 dark:text-red-300 dark:bg-red-900/30",children:[" ",(0,u.jsxs)("div",{className:"flex items-center",children:[" ",(0,u.jsx)(b.A,{size:20,className:"mr-2 flex-shrink-0"})," ",(0,u.jsx)("span",{children:fe})," "]})," "]}),(0,u.jsxs)("div",{className:"pt-2",children:[(0,u.jsx)("h3",{className:"text-xl font-semibold leading-7 text-apple-gray-900 dark:text-apple-gray-100",children:N("createOrder.form.customerInfo.title")}),(0,u.jsxs)("div",{className:"mt-2 mb-4 flex space-x-4",children:[" ",(0,u.jsx)(o.A,{type:"button",onClick:()=>{ye("existing"),ie(null),le({name:"",phone:"",email:"",address:""})},variant:"existing"===xe?"primary":"secondary",iconLeft:(0,u.jsx)(v.A,{size:16}),children:N("createOrder.form.customerInfo.existingCustomer")})," ",(0,u.jsx)(o.A,{type:"button",onClick:()=>{ye("new"),ie(null)},variant:"new"===xe?"primary":"secondary",iconLeft:(0,u.jsx)(j.A,{size:16}),children:N("createOrder.form.customerInfo.newCustomer")})," "]}),"existing"===xe&&(0,u.jsxs)("div",{className:"space-y-4 mb-4",children:[" ",(0,u.jsx)(i.A,{label:N("createOrder.form.customerInfo.searchCustomer"),id:"customerSearch",value:de,onChange:async e=>{const a=e.target.value;if(oe(a),a.length>1){ue(!0);try{const{data:e}=await(0,f.gn)(a);me((null===e||void 0===e?void 0:e.customers)||[])}catch(r){console.error(r),me([])}finally{ue(!1)}}else me([])},placeholder:N("createOrder.form.customerInfo.searchPlaceholder"),prefixIcon:pe?(0,u.jsx)(g.A,{size:"sm"}):(0,u.jsx)(v.A,{size:16})})," ",ce.length>0&&(0,u.jsxs)("ul",{className:"max-h-48 overflow-y-auto border border-apple-gray-300 dark:border-apple-gray-700 rounded-apple-md divide-y divide-apple-gray-200 dark:divide-apple-gray-700 bg-white dark:bg-apple-gray-800",children:[" ",ce.map(e=>(0,u.jsxs)("li",{onClick:()=>{return le({name:(a=e).name,phone:a.phone,email:a.email||"",address:a.address||""}),ie(a._id),oe(""),me([]),void ye("existing");var a},className:"p-3 hover:bg-apple-gray-100 dark:hover:bg-apple-gray-700/50 cursor-pointer",children:[" ",(0,u.jsx)("p",{className:"font-medium text-apple-gray-800 dark:text-apple-gray-200",children:e.name})," ",(0,u.jsxs)("p",{className:"text-sm text-apple-gray-500 dark:text-apple-gray-400",children:[e.phone," ",e.email&&`- ${e.email}`]})," "]},e._id))," "]})," ",ne&&(0,u.jsxs)("p",{className:"mt-2 text-sm text-apple-green flex items-center",children:[(0,u.jsx)(k,{size:16,className:"mr-1"})," ",N("createOrder.form.customerInfo.selected"),": ",se.name," (",se.phone,")"]})," "]}),(0,u.jsxs)("div",{className:`mt-2 grid grid-cols-1 gap-y-4 gap-x-6 sm:grid-cols-6 ${"existing"===xe&&!ne&&!m&&"opacity-60 pointer-events-none"}`,children:[(0,u.jsxs)("div",{className:"sm:col-span-3",children:[" ",(0,u.jsx)(i.A,{label:N("createOrder.form.customerInfo.fullName"),id:"customerNameInput",name:"name",value:se.name,onChange:Oe,required:"new"===xe})," "]}),(0,u.jsxs)("div",{className:"sm:col-span-3",children:[" ",(0,u.jsx)(i.A,{label:N("createOrder.form.customerInfo.phoneNumber"),id:"customerPhoneInput",name:"phone",type:"tel",value:se.phone,onChange:Oe,required:"new"===xe})," "]}),(0,u.jsxs)("div",{className:"sm:col-span-3",children:[" ",(0,u.jsx)(i.A,{label:N("createOrder.form.customerInfo.emailAddress"),id:"customerEmailInput",name:"email",type:"email",value:se.email,onChange:Oe})," "]}),(0,u.jsxs)("div",{className:"sm:col-span-3",children:[" ",(0,u.jsx)(i.A,{label:N("createOrder.form.customerInfo.address"),id:"customerAddressInput",name:"address",value:se.address,onChange:Oe})," "]})]})]}),(0,u.jsxs)("div",{className:"pt-8",children:[(0,u.jsx)("h3",{className:"text-xl font-semibold leading-7 text-apple-gray-900 dark:text-apple-gray-100",children:N("createOrder.form.items.title")}),(0,u.jsxs)("div",{className:"mt-6 space-y-4",children:[V.map((e,a)=>{const r=Ae(e.itemType,e.serviceType)*(parseInt(e.quantity,10)||0);return(0,u.jsx)(x,{item:e,index:a,onRemove:()=>{return a=e.id,_(V.filter(e=>e.id!==a));var a},onChange:Te,itemTypes:R.itemTypes,serviceTypes:R.serviceTypes.map(e=>({value:e.toLowerCase().trim(),label:e})),calculatedPrice:r,currencySymbol:R.currencySymbol},e.id)}),(0,u.jsx)(o.A,{type:"button",onClick:()=>_([...V,U()]),variant:"secondary",iconLeft:(0,u.jsx)(T.A,{size:16}),children:N("createOrder.form.items.addItem")})]})]}),(0,u.jsxs)("div",{className:"pt-8",children:[(0,u.jsx)("h3",{className:"text-xl font-semibold leading-7 text-apple-gray-900 dark:text-apple-gray-100",children:N("createOrder.form.summary.title")}),(0,u.jsxs)("div",{className:"mt-6 grid grid-cols-1 gap-y-4 gap-x-6 sm:grid-cols-6",children:[(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(i.A,{label:`${N("createOrder.form.summary.subtotal")} (${R.currencySymbol})`,id:"subTotal",type:"text",value:Ce.toFixed(2),readOnly:!0,className:"bg-apple-gray-100 dark:bg-apple-gray-800 cursor-default"})}),(0,u.jsxs)("div",{className:"sm:col-span-3",children:[" ",(0,u.jsx)(d.A,{label:N("createOrder.form.summary.discountType"),id:"discountType",value:E,onChange:e=>{Z(e.target.value),"none"===e.target.value&&Y("0")},options:[{value:"none",label:N("createOrder.form.summary.noDiscount")},{value:"percentage",label:N("createOrder.form.summary.percentage")},{value:"fixed",label:`${N("createOrder.form.summary.fixedAmount")} (${R.currencySymbol})`}]})," "]}),"none"!==E&&(0,u.jsxs)("div",{className:"sm:col-span-3",children:[" ",(0,u.jsx)(i.A,{label:`${N("createOrder.form.summary.discountValue")} ${"percentage"===E?"(%)":`(${R.currencySymbol})`}`,id:"discountValueState",type:"number",value:G,onChange:e=>Y(e.target.value),min:"0",step:"0.01"})," "]}),(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(i.A,{label:`${N("createOrder.form.summary.calculatedDiscount")} (${R.currencySymbol})`,id:"calculatedDiscountDisplay",type:"text",value:we.toFixed(2),readOnly:!0,className:"bg-apple-gray-100 dark:bg-apple-gray-800 cursor-default"})}),(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(i.A,{label:`${N("createOrder.form.summary.finalTotal")} (${R.currencySymbol})`,id:"finalTotalAmount",type:"text",value:Me.toFixed(2),readOnly:!0,className:"font-semibold bg-apple-gray-100 dark:bg-apple-gray-800 cursor-default"})}),(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(i.A,{label:`${N("createOrder.form.summary.advancePaid")} (${R.currencySymbol})`,id:"amountPaid",name:"amountPaid",type:"number",value:B,onChange:e=>W(e.target.value),step:"0.01",min:"0"})}),(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(i.A,{label:`${N("createOrder.form.summary.balanceDue")} (${R.currencySymbol})`,id:"balanceDueDisplay",type:"text",value:Ie.toFixed(2),readOnly:!0,className:`font-semibold cursor-default ${Ie>0?"text-apple-red dark:text-red-400":"text-apple-green dark:text-green-400"} bg-apple-gray-100 dark:bg-apple-gray-800`})}),(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(c.A,{label:N("createOrder.form.summary.expectedPickupDate"),id:"expectedPickupDateOnly",value:ee,onChange:e=>ae(e.target.value),required:!0,min:(0,M.GP)(new Date,"yyyy-MM-dd")})}),(0,u.jsx)("div",{className:"sm:col-span-3",children:(0,u.jsx)(i.A,{label:N("createOrder.form.summary.expectedPickupTime"),id:"expectedPickupTime",type:"time",value:re,onChange:e=>te(e.target.value),required:!0})}),(0,u.jsxs)("div",{className:"sm:col-span-6",children:[" ",(0,u.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300 mb-1",children:N("createOrder.form.summary.orderNotes")})," ",(0,u.jsx)("textarea",{id:"notes",name:"notes",rows:3,value:J,onChange:e=>K(e.target.value),className:"form-textarea block w-full sm:text-sm  border-apple-gray-300 focus:border-apple-blue focus:ring-apple-blue dark:bg-apple-gray-800 dark:border-apple-gray-700 dark:text-apple-gray-100 dark:focus:border-apple-blue rounded-apple shadow-apple-sm"})," "]})]})]}),(0,u.jsxs)("div",{className:"pt-6 flex items-center justify-end gap-x-3",children:[(0,u.jsx)(o.A,{type:"button",variant:"secondary",onClick:()=>D(m&&null!==r&&void 0!==r&&r._id?`/app/orders/${r._id}`:"/app/dashboard"),disabled:ge,children:N("createOrder.form.actions.cancel")}),(0,u.jsx)(o.A,{type:"submit",variant:"primary",isLoading:ge,iconLeft:(0,u.jsx)(O,{size:18}),children:N(m?"createOrder.form.actions.reviewChanges":"createOrder.form.actions.reviewOrder")})]})]}),ve&&Ne&&(0,u.jsxs)(y.A,{isOpen:ve,onClose:()=>{ge||je(!1)},title:N(m?"createOrder.form.confirmModal.titleEdit":"createOrder.form.confirmModal.titleNew"),size:"2xl",children:[(0,u.jsxs)("div",{className:"space-y-4 text-sm max-h-[70vh] overflow-y-auto p-1 custom-scrollbar",children:[(0,u.jsx)("h3",{className:"text-lg font-semibold text-apple-gray-800 dark:text-apple-gray-100",children:N("createOrder.form.confirmModal.reviewDetails")}),(0,u.jsxs)("div",{className:"p-3 border rounded-apple-md dark:border-apple-gray-700 bg-apple-gray-50 dark:bg-apple-gray-800/30",children:[" ",(0,u.jsx)("h4",{className:"font-medium mb-1 text-apple-gray-700 dark:text-apple-gray-200",children:N("createOrder.form.confirmModal.customer")})," ",(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.name")})," ",Ne.customer.name||(0,u.jsx)("span",{className:"italic text-apple-red",children:N("createOrder.form.confirmModal.missing")})]})," ",(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.phone")})," ",Ne.customer.phone||(0,u.jsx)("span",{className:"italic text-apple-red",children:N("createOrder.form.confirmModal.missing")})]})," ",Ne.customer.email&&(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.email")})," ",Ne.customer.email]})," ",Ne.customer.address&&(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.address")})," ",Ne.customer.address]})," "]}),(0,u.jsxs)("div",{className:"p-3 border rounded-apple-md dark:border-apple-gray-700 bg-apple-gray-50 dark:bg-apple-gray-800/30",children:[" ",(0,u.jsx)("h4",{className:"font-medium mb-2 text-apple-gray-700 dark:text-apple-gray-200",children:N("createOrder.form.confirmModal.items")})," ",Ne.items.length>0?Ne.items.map((e,a)=>{const r=Ae(e.itemType,e.serviceType)*(parseInt(e.quantity,10)||0);return(0,u.jsxs)("div",{className:"mb-2 pb-2 "+(a<Ne.items.length-1?"border-b dark:border-apple-gray-700/50":""),children:[" ",(0,u.jsxs)("div",{className:"flex justify-between",children:[" ",(0,u.jsxs)("span",{children:[(0,u.jsxs)("strong",{children:[e.quantity||0,"x ",e.itemType||(0,u.jsx)("span",{className:"italic text-apple-red",children:N("createOrder.form.confirmModal.missing")})]})," - ",N("createOrder.form.confirmModal.service"),": ",e.serviceType||(0,u.jsx)("span",{className:"italic text-apple-red",children:N("createOrder.form.confirmModal.missing")})]})," ",(0,u.jsxs)("span",{className:"font-medium",children:[R.currencySymbol,r.toFixed(2)]})," "]})," ",e.specialInstructions&&(0,u.jsxs)("p",{className:"text-xs italic text-apple-gray-600 dark:text-apple-gray-400",children:[N("createOrder.form.confirmModal.instructions"),": ",e.specialInstructions]})," "]},a)}):(0,u.jsx)("p",{className:"italic text-apple-gray-500",children:N("createOrder.form.confirmModal.noItems")})," "]}),(0,u.jsxs)("div",{className:"p-3 border rounded-apple-md dark:border-apple-gray-700 bg-apple-gray-50 dark:bg-apple-gray-800/30",children:[" ",(0,u.jsx)("h4",{className:"font-medium mb-1 text-apple-gray-700 dark:text-apple-gray-200",children:N("createOrder.form.confirmModal.summary")})," ",(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.subtotal")})," ",R.currencySymbol,Ne.subTotalAmount.toFixed(2)]})," ","none"!==Ne.discountType&&Ne.calculatedDiscountAmount>0&&(0,u.jsxs)("p",{children:[(0,u.jsxs)("strong",{children:[N("createOrder.form.confirmModal.discount")," (","percentage"===Ne.discountType?`${Ne.discountValue}%`:`${R.currencySymbol}${Ne.discountValue.toFixed(2)}`,"):"]})," -",R.currencySymbol,Ne.calculatedDiscountAmount.toFixed(2)]})," ",(0,u.jsxs)("p",{className:"text-base font-semibold",children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.finalTotal")})," ",R.currencySymbol,Ne.finalTotalAmount.toFixed(2)]})," ",(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.advancePaid")})," ",R.currencySymbol,Ne.amountPaid.toFixed(2)]})," ",(0,u.jsxs)("p",{className:"font-semibold "+(Ne.balanceDue>0?"text-apple-red":"text-apple-green"),children:[" ",(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.balanceDue")})," ",R.currencySymbol,Ne.balanceDue.toFixed(2)," "]})," ",(0,u.jsxs)("p",{children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.expectedPickup")})," ",Ne.expectedPickupDate?(0,M.GP)((0,S.H)(Ne.expectedPickupDate),"MMM d, yyyy, h:mm a"):(0,u.jsx)("span",{className:"italic text-apple-red",children:N("createOrder.form.confirmModal.missing")})]})," ",Ne.notes&&(0,u.jsxs)("p",{className:"mt-1",children:[(0,u.jsx)("strong",{children:N("createOrder.form.confirmModal.notes")})," ",(0,u.jsx)("span",{className:"block whitespace-pre-wrap",children:Ne.notes})]})," "]}),(0,u.jsx)("p",{className:"pt-2 text-center font-semibold text-apple-gray-700 dark:text-apple-gray-200",children:N("createOrder.form.confirmModal.isCorrect")})]}),(0,u.jsxs)("div",{className:"mt-6 pt-4 border-t dark:border-apple-gray-700 flex flex-wrap justify-end gap-3",children:[" ",(0,u.jsx)(o.A,{variant:"secondary",onClick:()=>je(!1),iconLeft:(0,u.jsx)(A,{size:16}),disabled:ge,children:N("createOrder.form.confirmModal.edit")})," ",(0,u.jsx)(o.A,{variant:"ghost",onClick:()=>je(!1),disabled:ge,className:"text-apple-red",iconLeft:(0,u.jsx)(C,{size:16}),children:N("common.cancel")})," ",(0,u.jsxs)(o.A,{variant:"primary",onClick:async()=>{if(!Ne)return be(N("createOrder.form.validation.internalError")),void je(!1);he(!0),be(""),je(!1);const e={items:Ne.items,expectedPickupDate:Ne.expectedPickupDate,subTotalAmount:Ne.subTotalAmount,discountType:Ne.discountType,discountValue:Ne.discountValue,amountPaid:Ne.amountPaid,notes:Ne.notes};"existing"===Ne.customerSelectionMode&&Ne.customer.id?(e.customerId=Ne.customer.id,e.customerDetailsToUpdate={name:Ne.customer.name,phone:Ne.customer.phone,email:Ne.customer.email,address:Ne.customer.address}):(e.customerName=Ne.customer.name,e.customerPhone=Ne.customer.phone,e.customerEmail=Ne.customer.email,e.customerAddress=Ne.customer.address);try{const a=m&&null!==r&&void 0!==r&&r._id?await(0,f.Vl)(r._id,e):await(0,f.Lc)(e);alert(N(m?"createOrder.form.validation.orderUpdated":"createOrder.form.validation.orderCreated",{receiptNumber:a.data.receiptNumber})),D(m?`/app/orders/${a.data._id}`:"/app/dashboard")}catch(s){var a,t;be((null===(a=s.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||N(m?"createOrder.form.validation.failedToSave":"createOrder.form.validation.failedToCreate"))}finally{he(!1)}},isLoading:ge,iconLeft:(0,u.jsx)(w.A,{size:16}),children:[" ",N(m?"createOrder.form.confirmModal.confirmSave":"createOrder.form.confirmModal.confirmCreate")," "]})," "]})]})]}):(0,u.jsx)(h.A,{children:(0,u.jsxs)("div",{className:"p-6 text-center",children:[(0,u.jsx)(b.A,{size:32,className:"mx-auto text-orange-500 mb-4"}),(0,u.jsx)("h3",{className:"font-semibold text-lg",children:N("createOrder.form.setupRequired")}),(0,u.jsx)("p",{className:"text-sm text-apple-gray-600 dark:text-apple-gray-400 mt-2",children:N("createOrder.form.noItemTypes")}),(0,u.jsx)(s.N_,{to:"/app/admin/settings",children:(0,u.jsx)(o.A,{className:"mt-4",children:N("createOrder.form.goToSettings")})})]})})}},1884:(e,a,r)=>{r.d(a,{A:()=>t});const t=(0,r(7784).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},3280:(e,a,r)=>{r.d(a,{A:()=>l});var t=r(5043),s=r(579);const l=e=>{let{label:a,id:r,type:l="text",value:n,onChange:i,placeholder:d,error:o,required:c,className:m="",inputClassName:p="",disabled:u=!1,prefix:x,prefixIcon:y,suffixIcon:g,helperText:h,containerStyle:f,...b}=e;return(0,s.jsxs)("div",{className:`mb-4 ${m}`,style:f,children:[a&&(0,s.jsx)("label",{htmlFor:r,className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300 mb-1",children:a}),(0,s.jsxs)("div",{className:"relative rounded-apple shadow-apple-sm",children:[x&&(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)("span",{className:"text-apple-gray-500 sm:text-sm",children:x})}),y&&(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:t.cloneElement(y,{className:"h-5 w-5 text-apple-gray-500 dark:text-apple-gray-400"})}),(0,s.jsx)("input",{type:l,id:r,name:r||b.name,value:null===n||void 0===n?"":n,onChange:i,placeholder:d,required:c,disabled:u,className:`\n                        form-input block w-full sm:text-sm\n                        border-apple-gray-300 focus:border-apple-blue focus:ring-apple-blue\n                        dark:bg-apple-gray-800 dark:border-apple-gray-700 dark:text-apple-gray-100\n                        dark:placeholder-apple-gray-500 dark:focus:border-apple-blue\n                        rounded-apple shadow-apple-sm\n                        ${o?"border-apple-red focus:border-apple-red focus:ring-apple-red":""}\n                        ${x||y?"pl-10":"px-3"}\n                        ${g?"pr-10":"px-3"}\n                        ${p}\n                    `.trim().replace(/\s+/g," "),...b}),g&&(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:g})]}),o&&(0,s.jsx)("p",{className:"mt-1.5 text-xs text-apple-red",children:o}),h&&!o&&(0,s.jsx)("p",{className:"mt-1.5 text-xs text-apple-gray-500 dark:text-apple-gray-400",children:h})]})}},4653:(e,a,r)=>{r.d(a,{H:()=>n});var t=r(4524),s=r(2440),l=r(2316);function n(e,a){const r=()=>(0,s.w)(a?.in,NaN),n=a?.additionalDigits??2,y=function(e){const a={},r=e.split(i.dateTimeDelimiter);let t;if(r.length>2)return a;/:/.test(r[0])?t=r[0]:(a.date=r[0],t=r[1],i.timeZoneDelimiter.test(a.date)&&(a.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(a.date.length,e.length)));if(t){const e=i.timezone.exec(t);e?(a.time=t.replace(e[1],""),a.timezone=e[1]):a.time=t}return a}(e);let g;if(y.date){const e=function(e,a){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+a)+"})|(\\d{2}|[+-]\\d{"+(2+a)+"})$)"),t=e.match(r);if(!t)return{year:NaN,restDateString:""};const s=t[1]?parseInt(t[1]):null,l=t[2]?parseInt(t[2]):null;return{year:null===l?s:100*l,restDateString:e.slice((t[1]||t[2]).length)}}(y.date,n);g=function(e,a){if(null===a)return new Date(NaN);const r=e.match(d);if(!r)return new Date(NaN);const t=!!r[4],s=m(r[1]),l=m(r[2])-1,n=m(r[3]),i=m(r[4]),o=m(r[5])-1;if(t)return function(e,a,r){return a>=1&&a<=53&&r>=0&&r<=6}(0,i,o)?function(e,a,r){const t=new Date(0);t.setUTCFullYear(e,0,4);const s=t.getUTCDay()||7,l=7*(a-1)+r+1-s;return t.setUTCDate(t.getUTCDate()+l),t}(a,i,o):new Date(NaN);{const e=new Date(0);return function(e,a,r){return a>=0&&a<=11&&r>=1&&r<=(u[a]||(x(e)?29:28))}(a,l,n)&&function(e,a){return a>=1&&a<=(x(e)?366:365)}(a,s)?(e.setUTCFullYear(a,l,Math.max(s,n)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!g||isNaN(+g))return r();const h=+g;let f,b=0;if(y.time&&(b=function(e){const a=e.match(o);if(!a)return NaN;const r=p(a[1]),s=p(a[2]),l=p(a[3]);if(!function(e,a,r){if(24===e)return 0===a&&0===r;return r>=0&&r<60&&a>=0&&a<60&&e>=0&&e<25}(r,s,l))return NaN;return r*t.s0+s*t.Cg+1e3*l}(y.time),isNaN(b)))return r();if(!y.timezone){const e=new Date(h+b),r=(0,l.a)(0,a?.in);return r.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),r.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),r}return f=function(e){if("Z"===e)return 0;const a=e.match(c);if(!a)return 0;const r="+"===a[1]?-1:1,s=parseInt(a[2]),l=a[3]&&parseInt(a[3])||0;if(!function(e,a){return a>=0&&a<=59}(0,l))return NaN;return r*(s*t.s0+l*t.Cg)}(y.timezone),isNaN(f)?r():(0,l.a)(h+b+f,a?.in)}const i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},d=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,o=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,c=/^([+-])(\d{2})(?::?(\d{2}))?$/;function m(e){return e?parseInt(e):1}function p(e){return e&&parseFloat(e.replace(",","."))||0}const u=[31,null,31,30,31,30,31,31,30,31,30,31];function x(e){return e%400===0||e%4===0&&e%100!==0}},5469:(e,a,r)=>{r.d(a,{A:()=>t});const t=(0,r(7784).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6174:(e,a,r)=>{r.d(a,{A:()=>s});r(5043);var t=r(579);const s=e=>{let{label:a,id:r,value:s,onChange:l,options:n=[],placeholder:i,error:d,required:o,className:c="",selectClassName:m="",disabled:p=!1,...u}=e;return(0,t.jsxs)("div",{className:`mb-4 ${c}`,children:[a&&(0,t.jsxs)("label",{htmlFor:r,className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300 mb-1",children:[a," ",o&&(0,t.jsx)("span",{className:"text-apple-red",children:"*"})]}),(0,t.jsxs)("select",{id:r,name:r||u.name,value:s,onChange:l,required:o,disabled:p,className:`\n                    \n        form-select block w-full sm:text-sm\n        border-apple-gray-300 focus:border-apple-blue focus:ring-apple-blue\n        dark:bg-apple-gray-800 dark:border-apple-gray-700 dark:text-apple-gray-100\n        dark:focus:border-apple-blue\n        rounded-apple shadow-apple-sm\n    \n                    ${d?"\n        border-apple-red focus:border-apple-red focus:ring-apple-red\n        dark:border-apple-red dark:focus:border-apple-red\n    ":""}\n                    ${m}\n                `.trim().replace(/\s+/g," "),...u,children:[i&&(0,t.jsx)("option",{value:"",children:i}),n.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}),d&&(0,t.jsx)("p",{className:"mt-1.5 text-xs text-apple-red",children:d})]})}},6260:(e,a,r)=>{r.d(a,{A:()=>s});r(5043);var t=r(579);const s=e=>{let{children:a,className:r="",title:s,actions:l,titleClassName:n="",contentClassName:i="",actionsClassName:d=""}=e;return(0,t.jsxs)("div",{className:`bg-white dark:bg-apple-gray-900 rounded-apple-lg shadow-apple overflow-hidden ${r}`,children:[s&&(0,t.jsx)("div",{className:`px-4 py-4 sm:px-6 border-b border-apple-gray-200 dark:border-apple-gray-800 ${n}`,children:"string"===typeof s?(0,t.jsx)("h3",{className:"text-lg leading-6 font-semibold text-apple-gray-900 dark:text-apple-gray-100",children:s}):s}),(0,t.jsx)("div",{className:`p-4 sm:p-6 ${i}`,children:a}),l&&(0,t.jsx)("div",{className:`px-4 py-3 sm:px-6 bg-apple-gray-50 dark:bg-apple-gray-950/50 border-t border-apple-gray-200 dark:border-apple-gray-800 ${d}`,children:l})]})}},7184:(e,a,r)=>{r.d(a,{A:()=>l});r(5043);var t=r(3280),s=r(579);const l=e=>{let{label:a,id:r,value:l,onChange:n,error:i,required:d,className:o="",...c}=e;return(0,s.jsx)(t.A,{label:a,id:r,type:"date",value:l,onChange:n,error:i,required:d,className:o,...c})}},8693:(e,a,r)=>{r.d(a,{A:()=>t});const t=(0,r(7784).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},9292:(e,a,r)=>{r.d(a,{A:()=>t});const t=(0,r(7784).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}}]);
//# sourceMappingURL=557.ab25ab64.chunk.js.map