/*! For license information please see 157.1b9e8559.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[157],{737:(e,a,s)=>{s.d(a,{A:()=>l});const l=(0,s(7784).A)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]])},2157:(e,a,s)=>{s.r(a),s.d(a,{default:()=>f});var l=s(5043),t=s(4117),n=s(9621),r=s(6260),i=s(3280),o=s(722),d=s(7457),c=s(6174),p=s(6833),m=s(7719),u=s(737),g=s(8693),x=s(7365),h=s(579);const b=()=>{const{t:e}=(0,t.Bd)(),[a,s]=(0,l.useState)({name:"",publicAddress:"",publicPhone:"",publicEmail:"",city:"",country:"",description:"",logoUrl:"",logoCloudinaryId:"",isListedInDirectory:!0}),[c,x]=(0,l.useState)(!0),[b,f]=(0,l.useState)(!1),[y,v]=(0,l.useState)(""),[j,N]=(0,l.useState)(""),[k,A]=(0,l.useState)(""),[C,w]=(0,l.useState)(!1),S=(0,l.useRef)(null);(0,l.useEffect)(()=>{(async()=>{x(!0),v("");try{const{data:e}=await(0,n.E4)();s(e),A(e.logoUrl||"")}catch(a){v(e("settings.publicProfile.loadError")),console.error("Load Tenant Profile Error:",a)}finally{x(!1)}})()},[]);const P=e=>{const{name:a,value:l,type:t,checked:n}=e.target;s(e=>({...e,[a]:"checkbox"===t?n:l}))};return c?(0,h.jsx)("div",{className:"p-4 flex justify-center",children:(0,h.jsx)(d.A,{})}):(0,h.jsx)(r.A,{title:e("settings.publicProfile.title"),className:"mb-8 shadow-apple-md",children:(0,h.jsxs)("form",{onSubmit:async l=>{l.preventDefault(),f(!0),v(""),N("");try{const{data:l}=await(0,n.Ju)(a);s(l),A(l.logoUrl||""),N(e("settings.publicProfile.saveSuccess"))}catch(i){var t,r;v((null===(t=i.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||e("settings.publicProfile.saveError")),console.error("Save Tenant Profile Error:",i)}finally{f(!1),setTimeout(()=>{N(""),v("")},4e3)}},children:[(0,h.jsxs)("div",{className:"p-4 space-y-4",children:[j&&(0,h.jsxs)("p",{className:"p-3 text-sm bg-green-100 text-apple-green rounded-apple flex items-center",children:[(0,h.jsx)(p.A,{size:18,className:"mr-2"}),j]}),y&&(0,h.jsxs)("p",{className:"p-3 text-sm bg-red-100 text-apple-red rounded-apple flex items-center",children:[(0,h.jsx)(m.A,{size:18,className:"mr-2"}),y]}),(0,h.jsx)("p",{className:"text-sm text-apple-gray-500 dark:text-apple-gray-400",children:e("settings.publicProfile.description")}),(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[(0,h.jsx)(i.A,{label:e("settings.publicProfile.businessName"),id:"name",name:"name",value:a.name||"",onChange:P,disabled:!0,helperText:e("settings.publicProfile.businessNameHelper")}),(0,h.jsx)(i.A,{label:e("settings.publicProfile.publicPhone"),id:"publicPhone",name:"publicPhone",value:a.publicPhone||"",onChange:P}),(0,h.jsx)(i.A,{label:e("settings.publicProfile.publicEmail"),id:"publicEmail",name:"publicEmail",type:"email",value:a.publicEmail||"",onChange:P}),(0,h.jsx)(i.A,{label:e("settings.publicProfile.city"),id:"city",name:"city",value:a.city||"",onChange:P}),(0,h.jsx)(i.A,{label:e("settings.publicProfile.country"),id:"country",name:"country",value:a.country||"",onChange:P}),(0,h.jsx)("div",{className:"md:col-span-2",children:(0,h.jsx)(i.A,{label:e("settings.publicProfile.publicAddress"),id:"publicAddress",name:"publicAddress",value:a.publicAddress||"",onChange:P})}),(0,h.jsxs)("div",{className:"md:col-span-2",children:[(0,h.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300",children:e("settings.publicProfile.shortDescription")}),(0,h.jsx)("textarea",{id:"description",name:"description",rows:"3",value:a.description||"",onChange:P,className:"form-textarea mt-1 block w-full text-black rounded-apple-md",placeholder:e("settings.publicProfile.descriptionPlaceholder")})]}),(0,h.jsxs)("div",{className:"md:col-span-2",children:[(0,h.jsx)("label",{className:"block text-sm font-medium mb-1",children:e("settings.publicProfile.businessLogo")}),(0,h.jsxs)("div",{className:"mt-1 flex items-center gap-4",children:[(0,h.jsx)("div",{className:"w-24 h-24 rounded-lg bg-apple-gray-100 dark:bg-apple-gray-800 flex items-center justify-center overflow-hidden",children:C?(0,h.jsx)(d.A,{}):k?(0,h.jsx)("img",{src:k,alt:"Logo Preview",className:"w-full h-full object-cover"}):(0,h.jsx)(u.A,{size:32,className:"text-apple-gray-400"})}),(0,h.jsx)("input",{type:"file",ref:S,onChange:async l=>{const t=l.target.files[0];if(!t)return;if(t.size>2097152)return void v(e("settings.publicProfile.logoError"));A(URL.createObjectURL(t)),w(!0),v("");const r=new FormData;r.append("logoImage",t);try{const{data:e}=await(0,n.NA)(r);s(a=>({...a,logoUrl:e.imageUrl,logoCloudinaryId:e.cloudinaryId}))}catch(d){var i,o;console.error("Logo upload failed:",d),v((null===(i=d.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.message)||e("settings.publicProfile.logoUploadError")),A(a.logoUrl||"")}finally{w(!1)}},className:"hidden",accept:"image/png, image/jpeg, image/webp"}),(0,h.jsx)(o.A,{type:"button",variant:"secondary",onClick:()=>S.current.click(),disabled:C,children:e(C?"settings.publicProfile.uploading":"settings.publicProfile.uploadImage")})]})]}),(0,h.jsxs)("div",{className:"md:col-span-2 flex items-center space-x-3 mt-2",children:[(0,h.jsx)("input",{type:"checkbox",id:"isListedInDirectory",name:"isListedInDirectory",checked:a.isListedInDirectory,onChange:P,className:"form-checkbox h-5 w-5 text-apple-blue"}),(0,h.jsx)("label",{htmlFor:"isListedInDirectory",className:"text-sm font-medium",children:e("settings.publicProfile.listInDirectory")})]})]})]}),(0,h.jsx)("div",{className:"flex justify-end p-4 bg-apple-gray-50 dark:bg-apple-gray-800/50 border-t",children:(0,h.jsx)(o.A,{type:"submit",isLoading:b,iconLeft:(0,h.jsx)(g.A,{size:16}),children:e("settings.publicProfile.saveProfile")})})]})})},f=()=>{var e,a,s,u,f,y,v,j;const{t:N}=(0,t.Bd)(),[k,A]=(0,l.useState)({companyInfo:{name:"",address:"",phone:"",logoUrl:""},notificationTemplates:{subject:"",readyForPickupBody:"",manualReminderSubject:"",manualReminderBody:"",whatsappOrderReadySid:"",whatsappManualReminderSid:""},defaultCurrencySymbol:"FCFA",preferredNotificationChannel:"whatsapp"}),[C,w]=(0,l.useState)(!0),[S,P]=(0,l.useState)(!1),[I,T]=(0,l.useState)(""),[E,R]=(0,l.useState)(""),L=(0,l.useCallback)(async()=>{w(!0),T("");try{const{data:e}=await(0,n.V3)();A(a=>({companyInfo:{...a.companyInfo||{},...e.companyInfo||{}},notificationTemplates:{...a.notificationTemplates||{},...e.notificationTemplates||{}},defaultCurrencySymbol:e.defaultCurrencySymbol||a.defaultCurrencySymbol,preferredNotificationChannel:e.preferredNotificationChannel||a.preferredNotificationChannel}))}catch(s){var e,a;T((null===(e=s.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.message)||N("settings.messages.loadError")),console.error("Load settings error:",s.response||s)}finally{w(!1)}},[]);(0,l.useEffect)(()=>{L()},[L]);const z=(e,a)=>{A(s=>{const l=JSON.parse(JSON.stringify(s));let t=l;for(let a=0;a<e.length-1;a++)t[e[a]]||(t[e[a]]={}),t=t[e[a]];return t[e[e.length-1]]=a,l})};return(0,l.useEffect)(()=>{let e;return(E||I)&&(e=setTimeout(()=>{R(""),T("")},5e3)),()=>clearTimeout(e)},[E,I]),C?(0,h.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,h.jsx)(d.A,{size:"lg"})}):!I||k&&k.companyInfo?(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,h.jsx)(x.A,{size:28,className:"text-apple-blue"}),(0,h.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-apple-gray-800 dark:text-apple-gray-100",children:N("settings.title")})]}),(0,h.jsx)(b,{}),E&&(0,h.jsxs)("div",{className:"p-3 mb-4 bg-green-100 text-apple-green rounded-apple border border-green-300 dark:border-green-700 dark:text-green-300 dark:bg-green-900/30",children:[" ",(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(p.A,{size:20,className:"mr-2 flex-shrink-0"}),(0,h.jsx)("span",{children:E})]})," "]}),I&&!E&&(0,h.jsxs)("div",{className:"p-3 mb-4 bg-red-100 text-apple-red rounded-apple border border-red-300 dark:border-red-700 dark:text-red-300 dark:bg-red-900/30",children:[" ",(0,h.jsxs)("div",{className:"flex items-center",children:[(0,h.jsx)(m.A,{size:20,className:"mr-2 flex-shrink-0"}),(0,h.jsx)("span",{children:I})]})," "]}),(0,h.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),P(!0),T(""),R("");const a={...k};["singletonKey","_id","__v","createdAt","updatedAt"].forEach(e=>delete a[e]);try{const e=await(0,n.se)(a);if(e&&e.data){const a=e.data;A(e=>({companyInfo:{...e.companyInfo||{},...a.companyInfo||{}},notificationTemplates:{...e.notificationTemplates||{},...a.notificationTemplates||{}},defaultCurrencySymbol:a.defaultCurrencySymbol||e.defaultCurrencySymbol,preferredNotificationChannel:a.preferredNotificationChannel||e.preferredNotificationChannel})),R(N("settings.messages.saveSuccess"))}else T(N("settings.messages.unexpectedResponse"))}catch(t){var s,l;const e=(null===(s=t.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||t.message||N("settings.messages.saveError");T(e),console.error("Save settings error caught:",t.response||t.message||t)}finally{P(!1)}},children:[(0,h.jsx)(r.A,{title:N("settings.companyInfo.title"),className:"mb-8 shadow-apple-md",children:(0,h.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-1",children:[(0,h.jsx)(i.A,{label:N("settings.companyInfo.companyName"),id:"companyName",value:(null===(e=k.companyInfo)||void 0===e?void 0:e.name)||"",onChange:e=>z(["companyInfo","name"],e.target.value)}),(0,h.jsx)(i.A,{label:N("settings.companyInfo.companyPhone"),id:"companyPhone",value:(null===(a=k.companyInfo)||void 0===a?void 0:a.phone)||"",onChange:e=>z(["companyInfo","phone"],e.target.value)}),(0,h.jsxs)("div",{className:"md:col-span-2",children:[" ",(0,h.jsx)(i.A,{label:N("settings.companyInfo.companyAddress"),id:"companyAddress",value:(null===(s=k.companyInfo)||void 0===s?void 0:s.address)||"",onChange:e=>z(["companyInfo","address"],e.target.value)})," "]}),(0,h.jsxs)("div",{className:"md:col-span-2",children:[" ",(0,h.jsx)(i.A,{label:N("settings.companyInfo.logoUrl"),id:"companyLogoUrl",value:(null===(u=k.companyInfo)||void 0===u?void 0:u.logoUrl)||"",onChange:e=>z(["companyInfo","logoUrl"],e.target.value)})," "]})]})}),(0,h.jsxs)(r.A,{title:N("settings.notifications.title"),className:"mb-8 shadow-apple-md",children:[(0,h.jsx)(i.A,{label:N("settings.notifications.defaultSubject"),id:"defaultSubject",value:(null===(f=k.notificationTemplates)||void 0===f?void 0:f.subject)||"",onChange:e=>z(["notificationTemplates","subject"],e.target.value),className:"mb-6",helperText:N("settings.notifications.subjectHelper")}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsx)("label",{htmlFor:"readyForPickupBody",className:"block text-sm font-medium mb-1",children:N("settings.notifications.readyForPickupBody")}),(0,h.jsx)("textarea",{id:"readyForPickupBody",rows:"6",className:"form-textarea block w-full sm:text-sm",value:(null===(y=k.notificationTemplates)||void 0===y?void 0:y.readyForPickupBody)||"",onChange:e=>z(["notificationTemplates","readyForPickupBody"],e.target.value)}),(0,h.jsx)("p",{className:"mt-1 text-xs text-apple-gray-500",children:N("settings.notifications.bodyHelper")})]}),(0,h.jsx)("h4",{className:"text-md font-semibold mt-6 mb-2 border-t pt-4",children:N("settings.notifications.whatsappTemplates")}),(0,h.jsx)("p",{className:"text-xs text-apple-gray-500 mb-4",children:N("settings.notifications.whatsappDescription")}),(0,h.jsx)(i.A,{label:N("settings.notifications.orderReadySid"),id:"whatsappOrderReadySid",value:(null===(v=k.notificationTemplates)||void 0===v?void 0:v.whatsappOrderReadySid)||"",onChange:e=>z(["notificationTemplates","whatsappOrderReadySid"],e.target.value),className:"mb-4",helperText:N("settings.notifications.orderReadyHelper")}),(0,h.jsx)(i.A,{label:N("settings.notifications.manualReminderSid"),id:"whatsappManualReminderSid",value:(null===(j=k.notificationTemplates)||void 0===j?void 0:j.whatsappManualReminderSid)||"",onChange:e=>z(["notificationTemplates","whatsappManualReminderSid"],e.target.value),helperText:N("settings.notifications.manualReminderHelper")})]}),(0,h.jsxs)(r.A,{title:N("settings.general.title"),className:"mb-8 shadow-apple-md",children:[(0,h.jsx)(i.A,{label:N("settings.general.currencySymbol"),id:"defaultCurrencySymbol",value:k.defaultCurrencySymbol||"",onChange:e=>A(a=>({...a,defaultCurrencySymbol:e.target.value})),className:"max-w-xs"}),(0,h.jsx)(c.A,{label:N("settings.general.notificationChannel"),id:"preferredNotificationChannel",value:k.preferredNotificationChannel||"whatsapp",onChange:e=>A(a=>({...a,preferredNotificationChannel:e.target.value})),options:[{value:"whatsapp",label:N("settings.general.channels.whatsapp")},{value:"email",label:N("settings.general.channels.email")},{value:"none",label:N("settings.general.channels.none")}],className:"mt-4",helperText:N("settings.general.channelHelper")})]}),(0,h.jsx)("div",{className:"flex justify-end pt-4",children:(0,h.jsxs)(o.A,{type:"submit",variant:"primary",isLoading:S,iconLeft:(0,h.jsx)(g.A,{size:18}),children:[" ",N("settings.actions.saveAll")," "]})})]})]}):(0,h.jsxs)("div",{className:"space-y-6",children:[(0,h.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,h.jsx)(x.A,{size:28,className:"text-apple-blue"}),(0,h.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-apple-gray-800 dark:text-apple-gray-100",children:N("settings.title")})]}),(0,h.jsxs)("div",{className:"p-4 text-center text-apple-red bg-red-50 dark:bg-red-900/30 rounded-apple border border-red-200 dark:border-red-700",children:[(0,h.jsx)(m.A,{size:32,className:"mx-auto mb-2"}),(0,h.jsx)("p",{children:I}),(0,h.jsx)(o.A,{onClick:L,variant:"secondary",className:"mt-3",children:N("settings.actions.tryAgain")})]})]})}},3280:(e,a,s)=>{s.d(a,{A:()=>n});var l=s(5043),t=s(579);const n=e=>{let{label:a,id:s,type:n="text",value:r,onChange:i,placeholder:o,error:d,required:c,className:p="",inputClassName:m="",disabled:u=!1,prefix:g,prefixIcon:x,suffixIcon:h,helperText:b,containerStyle:f,...y}=e;return(0,t.jsxs)("div",{className:`mb-4 ${p}`,style:f,children:[a&&(0,t.jsx)("label",{htmlFor:s,className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300 mb-1",children:a}),(0,t.jsxs)("div",{className:"relative rounded-apple shadow-apple-sm",children:[g&&(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)("span",{className:"text-apple-gray-500 sm:text-sm",children:g})}),x&&(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:l.cloneElement(x,{className:"h-5 w-5 text-apple-gray-500 dark:text-apple-gray-400"})}),(0,t.jsx)("input",{type:n,id:s,name:s||y.name,value:null===r||void 0===r?"":r,onChange:i,placeholder:o,required:c,disabled:u,className:`\n                        form-input block w-full sm:text-sm\n                        border-apple-gray-300 focus:border-apple-blue focus:ring-apple-blue\n                        dark:bg-apple-gray-800 dark:border-apple-gray-700 dark:text-apple-gray-100\n                        dark:placeholder-apple-gray-500 dark:focus:border-apple-blue\n                        rounded-apple shadow-apple-sm\n                        ${d?"border-apple-red focus:border-apple-red focus:ring-apple-red":""}\n                        ${g||x?"pl-10":"px-3"}\n                        ${h?"pr-10":"px-3"}\n                        ${m}\n                    `.trim().replace(/\s+/g," "),...y}),h&&(0,t.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:h})]}),d&&(0,t.jsx)("p",{className:"mt-1.5 text-xs text-apple-red",children:d}),b&&!d&&(0,t.jsx)("p",{className:"mt-1.5 text-xs text-apple-gray-500 dark:text-apple-gray-400",children:b})]})}},6174:(e,a,s)=>{s.d(a,{A:()=>t});s(5043);var l=s(579);const t=e=>{let{label:a,id:s,value:t,onChange:n,options:r=[],placeholder:i,error:o,required:d,className:c="",selectClassName:p="",disabled:m=!1,...u}=e;return(0,l.jsxs)("div",{className:`mb-4 ${c}`,children:[a&&(0,l.jsxs)("label",{htmlFor:s,className:"block text-sm font-medium text-apple-gray-700 dark:text-apple-gray-300 mb-1",children:[a," ",d&&(0,l.jsx)("span",{className:"text-apple-red",children:"*"})]}),(0,l.jsxs)("select",{id:s,name:s||u.name,value:t,onChange:n,required:d,disabled:m,className:`\n                    \n        form-select block w-full sm:text-sm\n        border-apple-gray-300 focus:border-apple-blue focus:ring-apple-blue\n        dark:bg-apple-gray-800 dark:border-apple-gray-700 dark:text-apple-gray-100\n        dark:focus:border-apple-blue\n        rounded-apple shadow-apple-sm\n    \n                    ${o?"\n        border-apple-red focus:border-apple-red focus:ring-apple-red\n        dark:border-apple-red dark:focus:border-apple-red\n    ":""}\n                    ${p}\n                `.trim().replace(/\s+/g," "),...u,children:[i&&(0,l.jsx)("option",{value:"",children:i}),r.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))]}),o&&(0,l.jsx)("p",{className:"mt-1.5 text-xs text-apple-red",children:o})]})}},6260:(e,a,s)=>{s.d(a,{A:()=>t});s(5043);var l=s(579);const t=e=>{let{children:a,className:s="",title:t,actions:n,titleClassName:r="",contentClassName:i="",actionsClassName:o=""}=e;return(0,l.jsxs)("div",{className:`bg-white dark:bg-apple-gray-900 rounded-apple-lg shadow-apple overflow-hidden ${s}`,children:[t&&(0,l.jsx)("div",{className:`px-4 py-4 sm:px-6 border-b border-apple-gray-200 dark:border-apple-gray-800 ${r}`,children:"string"===typeof t?(0,l.jsx)("h3",{className:"text-lg leading-6 font-semibold text-apple-gray-900 dark:text-apple-gray-100",children:t}):t}),(0,l.jsx)("div",{className:`p-4 sm:p-6 ${i}`,children:a}),n&&(0,l.jsx)("div",{className:`px-4 py-3 sm:px-6 bg-apple-gray-50 dark:bg-apple-gray-950/50 border-t border-apple-gray-200 dark:border-apple-gray-800 ${o}`,children:n})]})}},6833:(e,a,s)=>{s.d(a,{A:()=>l});const l=(0,s(7784).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},8693:(e,a,s)=>{s.d(a,{A:()=>l});const l=(0,s(7784).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])}}]);
//# sourceMappingURL=157.1b9e8559.chunk.js.map