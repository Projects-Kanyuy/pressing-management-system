{"version":3,"file":"static/js/835.15ede336.chunk.js","mappings":"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","sources":["../node_modules/lucide-react/src/icons/refresh-cw.ts","../node_modules/lucide-react/src/icons/message-square.ts","components/UI/Card.js","pages/Messaging/InboxPage.js"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8', key: 'v9h5vc' }],\n  ['path', { d: 'M21 3v5h-5', key: '1q7to0' }],\n  ['path', { d: 'M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16', key: '3uifl3' }],\n  ['path', { d: 'M8 16H3v5', key: '1cv678' }],\n];\n\n/**\n * @component @name RefreshCw\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAxMmE5IDkgMCAwIDEgOS05IDkuNzUgOS43NSAwIDAgMSA2Ljc0IDIuNzRMMjEgOCIgLz4KICA8cGF0aCBkPSJNMjEgM3Y1aC01IiAvPgogIDxwYXRoIGQ9Ik0yMSAxMmE5IDkgMCAwIDEtOSA5IDkuNzUgOS43NSAwIDAgMS02Ljc0LTIuNzRMMyAxNiIgLz4KICA8cGF0aCBkPSJNOCAxNkgzdjUiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/refresh-cw\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst RefreshCw = createLucideIcon('refresh-cw', __iconNode);\n\nexport default RefreshCw;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z', key: '1lielz' }],\n];\n\n/**\n * @component @name MessageSquare\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTVhMiAyIDAgMCAxLTIgMkg3bC00IDRWNWEyIDIgMCAwIDEgMi0yaDE0YTIgMiAwIDAgMSAyIDJ6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/message-square\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MessageSquare = createLucideIcon('message-square', __iconNode);\n\nexport default MessageSquare;\n","import React from 'react';\r\n\r\nconst Card = ({ children, className = '', title, actions, titleClassName='', contentClassName='', actionsClassName='' }) => {\r\n    return (\r\n        <div className={`bg-white dark:bg-apple-gray-900 rounded-apple-lg shadow-apple overflow-hidden ${className}`}>\r\n            {title && (\r\n                <div className={`px-4 py-4 sm:px-6 border-b border-apple-gray-200 dark:border-apple-gray-800 ${titleClassName}`}>\r\n                    {typeof title === 'string' ? (\r\n                        <h3 className=\"text-lg leading-6 font-semibold text-apple-gray-900 dark:text-apple-gray-100\">\r\n                            {title}\r\n                        </h3>\r\n                    ) : title }\r\n                </div>\r\n            )}\r\n            <div className={`p-4 sm:p-6 ${contentClassName}`}>\r\n                {children}\r\n            </div>\r\n            {actions && (\r\n                <div className={`px-4 py-3 sm:px-6 bg-apple-gray-50 dark:bg-apple-gray-950/50 border-t border-apple-gray-200 dark:border-apple-gray-800 ${actionsClassName}`}>\r\n                    {actions}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Card;","// client/src/pages/Messaging/InboxPage.js\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { fetchInboundMessagesApi } from '../../services/api';\r\nimport Card from '../../components/UI/Card';\r\nimport Button from '../../components/UI/Button';\r\nimport Spinner from '../../components/UI/Spinner';\r\nimport { Inbox, MessageSquare, AlertTriangle, RefreshCw } from 'lucide-react';\r\nimport { format, formatDistanceToNowStrict } from 'date-fns';\r\n\r\nconst MessageItem = ({ message }) => (\r\n    <li className=\"p-4 border-b border-apple-gray-200 dark:border-apple-gray-700 last:border-b-0 hover:bg-apple-gray-50 dark:hover:bg-apple-gray-800/50 transition-colors\">\r\n        <div className=\"flex justify-between items-start\">\r\n            <div className=\"flex-1\">\r\n                <div className=\"flex items-center space-x-2\">\r\n                    <span className=\"font-semibold text-apple-gray-800 dark:text-apple-gray-100\">\r\n                        {/* If customer is linked, show name, else show formatted phone */}\r\n                        {message.customerId?.name || message.from.replace('whatsapp:', '')}\r\n                    </span>\r\n                    {message.customerId && <span className=\"text-xs text-apple-gray-400 dark:text-apple-gray-500\">({message.from.replace('whatsapp:', '')})</span>}\r\n                </div>\r\n                <p className=\"mt-1 text-sm text-apple-gray-700 dark:text-apple-gray-300 whitespace-pre-wrap\">{message.body}</p>\r\n            </div>\r\n            <div className=\"text-right ml-4 flex-shrink-0\">\r\n                <p className=\"text-xs text-apple-gray-500 dark:text-apple-gray-400\" title={format(new Date(message.createdAt), 'MMM d, yyyy, h:mm a')}>\r\n                    {formatDistanceToNowStrict(new Date(message.createdAt), { addSuffix: true })}\r\n                </p>\r\n                {/* You can add a 'Reply' button here in the future */}\r\n                {/* <Button variant=\"ghost\" size=\"sm\" className=\"mt-1\">Reply</Button> */}\r\n            </div>\r\n        </div>\r\n    </li>\r\n);\r\n\r\n\r\nconst InboxPage = () => {\r\n    const { t } = useTranslation();\r\n    const [messages, setMessages] = useState([]);\r\n    const [pagination, setPagination] = useState({ page: 1, pages: 1, totalMessages: 0 });\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n\r\n    const loadMessages = useCallback(async (page = 1) => {\r\n        setLoading(true);\r\n        setError('');\r\n        try {\r\n            const { data } = await fetchInboundMessagesApi(page);\r\n            setMessages(data.messages || []);\r\n            setPagination({\r\n                page: data.page,\r\n                pages: data.pages,\r\n                totalMessages: data.totalMessages,\r\n            });\r\n        } catch (err) {\r\n            setError(err.response?.data?.message || t('inbox.error'));\r\n            console.error(\"Fetch Inbox Error:\", err);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadMessages(1); // Load first page on mount\r\n    }, [loadMessages]);\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\r\n                <div className=\"flex items-center space-x-3\">\r\n                    <Inbox size={28} className=\"text-apple-blue\" />\r\n                    <h1 className=\"text-2xl sm:text-3xl font-semibold\">{t('inbox.title')}</h1>\r\n                </div>\r\n                <Button variant=\"secondary\" onClick={() => loadMessages(pagination.page)} isLoading={loading} iconLeft={<RefreshCw size={16} />}>\r\n                    {t('inbox.refresh')}\r\n                </Button>\r\n            </div>\r\n\r\n            {error && (\r\n                <div className=\"p-3 my-4 text-sm bg-red-100 text-apple-red rounded-apple flex items-center\">\r\n                    <AlertTriangle size={18} className=\"mr-2\"/>{error}\r\n                </div>\r\n            )}\r\n\r\n            <Card contentClassName=\"p-0\">\r\n                {loading && messages.length === 0 ? (\r\n                    <div className=\"flex justify-center items-center h-64\"><Spinner size=\"lg\" /></div>\r\n                ) : messages.length === 0 ? (\r\n                    <div className=\"p-8 text-center text-apple-gray-500 dark:text-apple-gray-400\">\r\n                        <MessageSquare size={48} className=\"mx-auto mb-4\" />\r\n                        <h3 className=\"font-semibold text-lg\">{t('inbox.emptyTitle')}</h3>\r\n                        <p className=\"text-sm mt-1\">{t('inbox.emptyDescription')}</p>\r\n                    </div>\r\n                ) : (\r\n                    <ul>\r\n                        {messages.map(message => (\r\n                            <MessageItem key={message._id} message={message} />\r\n                        ))}\r\n                    </ul>\r\n                )}\r\n                 {/* Pagination Controls */}\r\n                {pagination.pages > 1 && (\r\n                    <div className=\"p-4 border-t border-apple-gray-200 dark:border-apple-gray-700 flex justify-between items-center text-sm\">\r\n                        <span>{t('inbox.pagination.pageInfo', { \r\n                            currentPage: pagination.page, \r\n                            totalPages: pagination.pages, \r\n                            totalMessages: pagination.totalMessages \r\n                        })}</span>\r\n                        <div className=\"space-x-2\">\r\n                            <Button onClick={() => loadMessages(pagination.page - 1)} disabled={pagination.page <= 1 || loading} variant=\"secondary\" size=\"sm\">{t('inbox.pagination.previous')}</Button>\r\n                            <Button onClick={() => loadMessages(pagination.page + 1)} disabled={pagination.page >= pagination.pages || loading} variant=\"secondary\" size=\"sm\">{t('inbox.pagination.next')}</Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </Card>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InboxPage;"],"names":["RefreshCw","createLucideIcon","d","key","MessageSquare","_ref","children","className","title","actions","titleClassName","contentClassName","actionsClassName","_jsxs","_jsx","MessageItem","_message$customerId","message","customerId","name","from","replace","body","format","Date","createdAt","formatDistanceToNowStrict","addSuffix","InboxPage","t","useTranslation","messages","setMessages","useState","pagination","setPagination","page","pages","totalMessages","loading","setLoading","error","setError","loadMessages","useCallback","async","arguments","length","undefined","data","fetchInboundMessagesApi","err","_err$response","_err$response$data","response","console","useEffect","Inbox","size","Button","variant","onClick","isLoading","iconLeft","AlertTriangle","Card","Spinner","map","_id","currentPage","totalPages","disabled"],"sourceRoot":""}